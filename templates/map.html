{% extends "base.html" %}
{% set active_page = "map" %}

{% block title %}LineAgeMap â€” Map{% endblock %}

{% block content %}
  <div class="appFrameShell">
    <div class="appFrameCard">
  <div class="nav-family" style="margin: 16px auto 6px; max-width: 1100px;">
    {% if public_slug %}
      <div class="pillTitle">PUBLIC FAMILY MAP</div>
    {% elif sample_id %}
      <div class="pillTitle">SAMPLE MAP</div>
    {% else %}
      <div class="pillTitle">MY FAMILY MAP</div>
    {% endif %}
  </div>

  <section class="mapShell" aria-label="Family Map" style="max-width: 1100px; margin: 0 auto 22px;">
    <div id="mapRoot" class="mapRoot">
      <div class="mapLegend">
        <div class="mapLegendTitle">Locations</div>
        <div class="mapLegendSub">Tap a country to zoom into regions and cities.</div>
      </div>

      <div id="mapAccordion" class="mapAccordion" aria-live="polite"></div>
    </div>
  </section>
    </div>
  </div>
{% endblock %}

{% block scripts %}
  <script>
    // Data source selection for map.
    {% if public_slug %}
      window.MAP_API_URL = "/api/public/{{ public_slug }}/tree";
    {% elif sample_id %}
      window.MAP_API_URL = "/api/sample/{{ sample_id }}/tree";
    {% elif current_user %}
      window.MAP_API_URL = "/api/tree/me";
    {% else %}
      window.MAP_FAMILY_ID = window.MAP_FAMILY_ID || "got";
    {% endif %}
  </script>
  <script src="{{ url_for('static', filename='js/map-accordion.js') }}"></script>
{% endblock %}
